<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
		<title>car-car</title>
	</head>
	<body>
		<canvas id="canvas" width="320" height="240"></canvas>
		<script type="text/javascript">
			var ctx = document.getElementById('canvas').getContext('2d');

			// http://paulirish.com/2011/requestanimationframe-for-smart-animating/
			(function() {
			    var lastTime = 0;
			    var vendors = ['ms', 'moz', 'webkit', 'o'];
			    for(var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {
			        window.requestAnimationFrame = window[vendors[x]+'RequestAnimationFrame'];
			        window.cancelAnimationFrame = 
			          window[vendors[x]+'CancelAnimationFrame'] || window[vendors[x]+'CancelRequestAnimationFrame'];
			    }
			 
			    if (!window.requestAnimationFrame)
			        window.requestAnimationFrame = function(callback, element) {
			            var currTime = new Date().getTime();
			            var timeToCall = Math.max(0, 16 - (currTime - lastTime));
			            var id = window.setTimeout(function() { callback(currTime + timeToCall); }, 
			              timeToCall);
			            lastTime = currTime + timeToCall;
			            return id;
			        };
			 
			    if (!window.cancelAnimationFrame)
			        window.cancelAnimationFrame = function(id) {
			            clearTimeout(id);
			        };
			}());

			var z = 0, width = 320, height = 240;
			requestAnimationFrame(function() {
				// place the requestAnimFrame *before* the render() to assure as close to 
				// 60fps with the setTimeout fallback.
				requestAnimationFrame(arguments.callee);

				// clear canvas
				ctx.clearRect(0, 0, width, height);

				// render
				ctx.save();
				ctx.beginPath();
				ctx.moveTo(0, z);
				ctx.lineTo(width, z);
				ctx.stroke();
				ctx.restore();

				if(z === height) {
					z = 0;
				} else {
					z++
				}
			});
		</script>
	</body>
</html>
